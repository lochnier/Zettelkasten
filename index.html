<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Zettelkasten">
<title>Zettelkasten</title>

<!-- App Icons -->
<link rel="apple-touch-icon" id="app-icon" href="">
<link rel="icon" id="favicon" href="">

<!-- Theme Color -->
<meta name="theme-color" content="#1c1c1e" media="(prefers-color-scheme: dark)">
<meta name="theme-color" content="#f2f2f7" media="(prefers-color-scheme: light)">

<script>
// Generate app icon
(function() {
  const canvas = document.createElement('canvas');
  canvas.width = 180;
  canvas.height = 180;
  const ctx = canvas.getContext('2d');
  
  const gradient = ctx.createLinearGradient(0, 0, 180, 180);
  gradient.addColorStop(0, '#0a84ff');
  gradient.addColorStop(1, '#32d74b');
  ctx.fillStyle = gradient;
  
  const radius = 40;
  ctx.beginPath();
  ctx.moveTo(radius, 0);
  ctx.lineTo(180 - radius, 0);
  ctx.quadraticCurveTo(180, 0, 180, radius);
  ctx.lineTo(180, 180 - radius);
  ctx.quadraticCurveTo(180, 180, 180 - radius, 180);
  ctx.lineTo(radius, 180);
  ctx.quadraticCurveTo(0, 180, 0, 180 - radius);
  ctx.lineTo(0, radius);
  ctx.quadraticCurveTo(0, 0, radius, 0);
  ctx.closePath();
  ctx.fill();
  
  ctx.fillStyle = 'white';
  ctx.strokeStyle = 'white';
  ctx.lineWidth = 3;
  ctx.lineCap = 'round';
  ctx.lineJoin = 'round';
  
  ctx.fillRect(40, 45, 100, 6);
  ctx.fillRect(40, 63, 80, 6);
  ctx.fillRect(40, 81, 90, 6);
  
  const nodes = [{ x: 55, y: 110 }, { x: 90, y: 110 }, { x: 125, y: 110 }];
  ctx.beginPath();
  ctx.moveTo(nodes[0].x, nodes[0].y);
  ctx.lineTo(nodes[1].x, nodes[1].y);
  ctx.lineTo(nodes[2].x, nodes[2].y);
  ctx.stroke();
  
  nodes.forEach(node => {
    ctx.beginPath();
    ctx.arc(node.x, node.y, 8, 0, Math.PI * 2);
    ctx.fill();
  });
  
  const iconUrl = canvas.toDataURL('image/png');
  document.getElementById('app-icon').href = iconUrl;
  document.getElementById('favicon').href = iconUrl;
})();
</script>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Caveat:wght@400;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/marked/9.1.6/marked.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>

<style>
  * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
  
  :root {
    --bg: #2a2a2e;
    --desk-surface: linear-gradient(135deg, #1a1a1d 0%, #2a2a2e 100%);
    --card-bg: #2c2c2e;
    --card-surface: #ffffff;
    --card-line: #ececec;
    --text: #1a1a1a;
    --text-secondary: #666666;
    --text-muted: #999999;
    --accent: #0a84ff;
    --green: #32d74b;
    --orange: #ff9f0a;
    --blue: #0a84ff;
    --red: #ff453a;
    --yellow: #ffd60a;
    --tab-bar-height: 68px;
    --safe-area-bottom: env(safe-area-inset-bottom, 0px);
  }
  
  [data-theme="light"] {
    --bg: #f5f5f7;
    --desk-surface: linear-gradient(135deg, #e8e8ea 0%, #f5f5f7 100%);
    --card-bg: #e5e5ea;
    --card-surface: #ffffff;
    --card-line: #ececec;
  }
  
  body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    background: var(--bg);
    background-image: var(--desk-surface);
    overflow: hidden;
    position: fixed;
    inset: 0;
    user-select: none;
  }
  
  /* ‚îÄ‚îÄ APP STRUCTURE ‚îÄ‚îÄ */
  #app {
    display: flex;
    flex-direction: column;
    height: 100vh;
    height: 100dvh;
  }
  
  #main-container {
    flex: 1;
    position: relative;
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
    padding-bottom: calc(var(--tab-bar-height) + var(--safe-area-bottom));
  }
  
  /* ‚îÄ‚îÄ CARD STACK ‚îÄ‚îÄ */
  #card-stack {
    position: absolute;
    inset: 16px;
    inset-bottom: calc(16px + var(--tab-bar-height) + var(--safe-area-bottom));
    display: flex;
    align-items: center;
    justify-content: center;
    perspective: 1000px;
  }
  
  .index-card {
    position: absolute;
    width: calc(100% - 24px);
    height: calc(100% - 24px);
    background: #ffffff;
    border-radius: 16px;
    box-shadow: 
      0 2px 8px rgba(0,0,0,0.08),
      0 8px 24px rgba(0,0,0,0.12);
    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), 
                opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1),
                box-shadow 0.3s;
    cursor: grab;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }
  
  .index-card:active {
    cursor: grabbing;
  }
  
  /* Stack effect - cards behind current */
  .index-card.stack-1 {
    transform: translateY(12px) scale(0.97) rotateX(2deg);
    opacity: 0.7;
    z-index: 1;
    box-shadow: 
      0 2px 8px rgba(0,0,0,0.15),
      0 8px 24px rgba(0,0,0,0.2);
  }
  
  .index-card.stack-2 {
    transform: translateY(24px) scale(0.94) rotateX(3deg);
    opacity: 0.4;
    z-index: 0;
    box-shadow: 
      0 2px 8px rgba(0,0,0,0.1),
      0 4px 16px rgba(0,0,0,0.15);
  }
  
  .index-card.current {
    z-index: 10;
    transform: translateY(0) scale(1) rotateX(0deg);
    opacity: 1;
    box-shadow: 
      0 2px 4px rgba(0,0,0,0.1),
      0 8px 20px rgba(0,0,0,0.2),
      0 20px 50px rgba(0,0,0,0.3);
  }
  
  .index-card.hidden {
    display: none;
  }
  
  /* Card type indicator - corner fold */
  .card-corner {
    position: absolute;
    top: 0;
    right: 0;
    width: 50px;
    height: 50px;
    overflow: hidden;
    z-index: 5;
  }
  
  .card-corner::before {
    content: '';
    position: absolute;
    top: -25px;
    right: -25px;
    width: 70px;
    height: 70px;
    transform: rotate(45deg);
  }
  
  .card-corner.fleeting::before { background: var(--orange); }
  .card-corner.literature::before { background: var(--blue); }
  .card-corner.permanent::before { background: var(--green); }
  
  /* Card header */
  .card-header {
    padding: 28px 28px 20px;
    border-bottom: 1px solid #ececec;
    background: var(--card-surface);
  }
  
  .card-title {
    font-size: 32px;
    font-weight: 700;
    color: var(--text);
    margin-bottom: 12px;
    line-height: 1.2;
    word-break: break-word;
  }
  
  .card-meta {
    display: flex;
    align-items: center;
    gap: 12px;
    font-size: 15px;
    color: var(--text-muted);
    flex-wrap: wrap;
  }
  
  .card-meta-item {
    display: flex;
    align-items: center;
    gap: 4px;
  }
  
  .card-tag {
    background: #f0f0f0;
    padding: 3px 8px;
    border-radius: 6px;
    font-size: 12px;
    color: var(--text-secondary);
  }
  
  /* Card body */
  .card-body {
    flex: 1;
    padding: 28px;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    font-size: 22px;
    line-height: 1.7;
    color: var(--text);
    font-family: 'Caveat', cursive;
  }
  
  .card-body-print {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    font-size: 18px;
  }
  
  /* Card footer */
  .card-footer {
    padding: 20px 28px;
    border-top: 1px solid #ececec;
    display: flex;
    align-items: center;
    justify-content: space-between;
    background: var(--card-surface);
  }
  
  .card-actions {
    display: flex;
    gap: 12px;
  }
  
  .card-btn {
    width: 52px;
    height: 52px;
    border-radius: 26px;
    border: 2px solid #e0e0e0;
    background: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    cursor: pointer;
    transition: all 0.2s;
  }
  
  .card-btn:active {
    transform: scale(0.9);
    background: #f5f5f5;
  }
  
  .card-btn.primary {
    background: var(--accent);
    border-color: var(--accent);
    color: white;
  }
  
  .card-position {
    font-size: 16px;
    color: var(--text-muted);
    font-weight: 500;
  }
  
  /* Empty state */
  .empty-card {
    background: #ffffff;
    border-radius: 16px;
    box-shadow: 
      0 2px 8px rgba(0,0,0,0.08),
      0 8px 24px rgba(0,0,0,0.12);
    width: calc(100% - 24px);
    height: calc(100% - 24px);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    padding: 40px;
  }
  
  .empty-icon {
    font-size: 72px;
    margin-bottom: 20px;
    opacity: 0.5;
  }
  
  .empty-title {
    font-size: 24px;
    font-weight: 700;
    color: var(--text);
    margin-bottom: 8px;
  }
  
  .empty-desc {
    font-size: 16px;
    color: var(--text-secondary);
    line-height: 1.5;
  }
  
  /* ‚îÄ‚îÄ TAB BAR ‚îÄ‚îÄ */
  #tab-bar {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    height: calc(var(--tab-bar-height) + var(--safe-area-bottom));
    padding-bottom: var(--safe-area-bottom);
    background: rgba(28, 28, 30, 0.95);
    backdrop-filter: blur(20px);
    border-top: 0.5px solid rgba(255,255,255,0.1);
    display: flex;
    justify-content: space-around;
    z-index: 100;
  }
  
  [data-theme="light"] #tab-bar {
    background: rgba(242, 242, 247, 0.95);
    border-top-color: rgba(0,0,0,0.1);
  }
  
  .tab-item {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 4px;
    cursor: pointer;
    transition: all 0.2s;
    padding: 8px;
    color: #999999;
  }
  
  [data-theme="light"] .tab-item {
    color: #666666;
  }
  
  .tab-icon {
    font-size: 24px;
    transition: all 0.2s;
  }
  
  .tab-label {
    font-size: 10px;
    font-weight: 500;
    transition: all 0.2s;
  }
  
  .tab-item.active {
    color: var(--accent);
  }
  
  /* ‚îÄ‚îÄ MODALS ‚îÄ‚îÄ */
  .modal-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.6);
    backdrop-filter: blur(8px);
    z-index: 200;
    display: none;
    opacity: 0;
    transition: opacity 0.3s;
  }
  
  .modal-overlay.visible {
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 1;
  }
  
  .modal {
    background: var(--card-surface);
    border-radius: 16px;
    width: calc(100% - 40px);
    max-width: 500px;
    max-height: 80vh;
    overflow: hidden;
    transform: scale(0.9);
    transition: transform 0.3s;
    display: flex;
    flex-direction: column;
  }
  
  .modal-overlay.visible .modal {
    transform: scale(1);
  }
  
  .modal-header {
    padding: 20px 20px 16px;
    border-bottom: 1px solid #e0e0e0;
    display: flex;
    align-items: center;
    justify-content: space-between;
  }
  
  .modal-title {
    font-size: 20px;
    font-weight: 700;
    color: var(--text);
  }
  
  .modal-close {
    width: 32px;
    height: 32px;
    border-radius: 16px;
    background: #f0f0f0;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 20px;
    color: var(--text-secondary);
  }
  
  .modal-body {
    padding: 20px;
    overflow-y: auto;
    flex: 1;
  }
  
  .modal-footer {
    padding: 16px 20px calc(16px + var(--safe-area-bottom));
    border-top: 1px solid #e0e0e0;
    display: flex;
    gap: 12px;
  }
  
  .modal-btn {
    flex: 1;
    padding: 14px;
    border-radius: 10px;
    border: none;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
  }
  
  .modal-btn.primary {
    background: var(--accent);
    color: white;
  }
  
  .modal-btn.secondary {
    background: #f0f0f0;
    color: var(--text);
  }
  
  .modal-btn:active {
    transform: scale(0.98);
  }
  
  /* Form elements */
  .form-group {
    margin-bottom: 20px;
  }
  
  .form-label {
    display: block;
    font-size: 14px;
    font-weight: 600;
    color: var(--text-secondary);
    margin-bottom: 8px;
  }
  
  .form-input {
    width: 100%;
    padding: 12px;
    border: 2px solid #e0e0e0;
    border-radius: 8px;
    font-size: 16px;
    font-family: inherit;
    background: white;
    color: var(--text);
  }
  
  .form-input:focus {
    outline: none;
    border-color: var(--accent);
  }
  
  .form-textarea {
    min-height: 200px;
    resize: vertical;
    font-family: 'Caveat', cursive;
    font-size: 18px;
    line-height: 1.6;
  }
  
  .type-selector {
    display: flex;
    gap: 8px;
  }
  
  .type-option {
    flex: 1;
    padding: 12px;
    border: 2px solid #e0e0e0;
    border-radius: 8px;
    text-align: center;
    cursor: pointer;
    transition: all 0.2s;
    font-size: 14px;
    font-weight: 500;
  }
  
  .type-option.active {
    border-color: var(--accent);
    background: rgba(10,132,255,0.1);
    color: var(--accent);
  }
  
  /* Browse view */
  .browse-container {
    padding: 20px;
    max-width: 600px;
    margin: 0 auto;
  }
  
  .browse-header {
    margin-bottom: 20px;
  }
  
  .browse-title {
    font-size: 32px;
    font-weight: 700;
    color: white;
    margin-bottom: 12px;
  }
  
  .search-bar {
    background: rgba(255,255,255,0.1);
    border-radius: 12px;
    padding: 12px 16px;
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 12px;
  }
  
  .search-input {
    flex: 1;
    background: transparent;
    border: none;
    outline: none;
    color: white;
    font-size: 16px;
  }
  
  .search-input::placeholder {
    color: rgba(255,255,255,0.5);
  }
  
  .filter-pills {
    display: flex;
    gap: 8px;
    overflow-x: auto;
    scrollbar-width: none;
    padding-bottom: 4px;
  }
  
  .filter-pills::-webkit-scrollbar {
    display: none;
  }
  
  .filter-pill {
    padding: 8px 16px;
    border-radius: 20px;
    background: rgba(255,255,255,0.1);
    color: rgba(255,255,255,0.7);
    font-size: 14px;
    white-space: nowrap;
    cursor: pointer;
    transition: all 0.2s;
  }
  
  .filter-pill.active {
    background: var(--accent);
    color: white;
  }
  
  .note-list-item {
    background: rgba(255,255,255,0.05);
    padding: 16px;
    border-radius: 12px;
    margin-bottom: 12px;
    cursor: pointer;
    transition: all 0.2s;
  }
  
  .note-list-item:active {
    background: rgba(255,255,255,0.1);
    transform: scale(0.98);
  }
  
  .note-list-title {
    font-size: 18px;
    font-weight: 600;
    color: white;
    margin-bottom: 4px;
  }
  
  .note-list-preview {
    font-size: 14px;
    color: rgba(255,255,255,0.6);
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  
  /* Toast */
  #toast {
    position: fixed;
    top: 60px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0,0,0,0.9);
    color: white;
    padding: 14px 20px;
    border-radius: 12px;
    font-size: 15px;
    z-index: 300;
    opacity: 0;
    transition: opacity 0.3s;
    pointer-events: none;
  }
  
  #toast.visible {
    opacity: 1;
  }
  
  /* Graph view */
  #graph-container {
    width: 100%;
    height: 100%;
  }
  
  #graph-svg {
    width: 100%;
    height: 100%;
  }
  
  .hidden { display: none !important; }
</style>
</head>
<body>

<div id="app">
  <div id="main-container">
    <!-- Card Stack View -->
    <div id="card-stack-view" class="view-content">
      <div id="card-stack">
        <!-- Cards populated by JS -->
      </div>
    </div>
    
    <!-- Browse View -->
    <div id="browse-view" class="view-content hidden">
      <div class="browse-container">
        <div class="browse-header">
          <div class="browse-title">Your Notes</div>
          <div class="search-bar">
            <span>üîç</span>
            <input type="text" class="search-input" id="browse-search" placeholder="Search notes..." oninput="filterBrowse(this.value)">
          </div>
          <div class="filter-pills">
            <div class="filter-pill active" onclick="setBrowseFilter('all', this)">All</div>
            <div class="filter-pill" onclick="setBrowseFilter('fleeting', this)">üü† Fleeting</div>
            <div class="filter-pill" onclick="setBrowseFilter('literature', this)">üîµ Literature</div>
            <div class="filter-pill" onclick="setBrowseFilter('permanent', this)">üü¢ Permanent</div>
            <div class="filter-pill" onclick="setBrowseFilter('starred', this)">‚≠ê Starred</div>
          </div>
        </div>
        <div id="browse-list">
          <!-- List populated by JS -->
        </div>
      </div>
    </div>
    
    <!-- Graph View -->
    <div id="graph-view" class="view-content hidden">
      <div id="graph-container">
        <svg id="graph-svg"></svg>
      </div>
    </div>
  </div>
  
  <!-- Tab Bar -->
  <div id="tab-bar">
    <div class="tab-item active" onclick="switchView('stack')">
      <div class="tab-icon">üìá</div>
      <div class="tab-label">Cards</div>
    </div>
    <div class="tab-item" onclick="switchView('browse')">
      <div class="tab-icon">üìã</div>
      <div class="tab-label">Browse</div>
    </div>
    <div class="tab-item" onclick="openNewNote()">
      <div class="tab-icon">‚ûï</div>
      <div class="tab-label">New</div>
    </div>
    <div class="tab-item" onclick="switchView('graph')">
      <div class="tab-icon">‚¨°</div>
      <div class="tab-label">Graph</div>
    </div>
    <div class="tab-item" onclick="openSettings()">
      <div class="tab-icon">‚öôÔ∏è</div>
      <div class="tab-label">More</div>
    </div>
  </div>
</div>

<!-- Edit Modal -->
<div class="modal-overlay" id="edit-modal">
  <div class="modal">
    <div class="modal-header">
      <div class="modal-title" id="edit-modal-title">Edit Note</div>
      <div class="modal-close" onclick="closeEditModal()">‚úï</div>
    </div>
    <div class="modal-body">
      <div class="form-group">
        <label class="form-label">Title</label>
        <input type="text" class="form-input" id="edit-title" placeholder="Note title...">
      </div>
      <div class="form-group">
        <label class="form-label">Type</label>
        <div class="type-selector">
          <div class="type-option" data-type="fleeting" onclick="selectType('fleeting', this)">
            üü†<br>Fleeting
          </div>
          <div class="type-option" data-type="literature" onclick="selectType('literature', this)">
            üîµ<br>Literature
          </div>
          <div class="type-option" data-type="permanent" onclick="selectType('permanent', this)">
            üü¢<br>Permanent
          </div>
        </div>
      </div>
      <div class="form-group">
        <label class="form-label">Content</label>
        <textarea class="form-input form-textarea" id="edit-body" placeholder="Write your note... Use [[links]] and #tags"></textarea>
      </div>
    </div>
    <div class="modal-footer">
      <button class="modal-btn secondary" onclick="closeEditModal()">Cancel</button>
      <button class="modal-btn primary" onclick="saveEditedNote()">Save</button>
    </div>
  </div>
</div>

<!-- Settings Modal -->
<div class="modal-overlay" id="settings-modal">
  <div class="modal">
    <div class="modal-header">
      <div class="modal-title">Settings</div>
      <div class="modal-close" onclick="closeSettings()">‚úï</div>
    </div>
    <div class="modal-body">
      <div class="form-group">
        <label class="form-label">Theme</label>
        <div class="type-selector">
          <div class="type-option" onclick="setTheme('dark', this)">üåô Dark</div>
          <div class="type-option" onclick="setTheme('light', this)">‚òÄÔ∏è Light</div>
        </div>
      </div>
      <div class="form-group">
        <label class="form-label">Export Data</label>
        <button class="modal-btn secondary" onclick="exportData()">üì§ Export All Notes (JSON)</button>
      </div>
      <div class="form-group">
        <label class="form-label">Statistics</label>
        <div style="color: var(--text-secondary); font-size: 14px; line-height: 1.8;">
          <div><strong id="stat-notes">0</strong> notes</div>
          <div><strong id="stat-links">0</strong> connections</div>
          <div><strong id="stat-tags">0</strong> unique tags</div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Toast -->
<div id="toast"></div>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  DATA & STATE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

let notes = {};
let currentCardIndex = 0;
let currentView = 'stack';
let editingNoteId = null;
let browseFilter = 'all';
let browseQuery = '';

const STORAGE_KEY = 'zettelkasten_cards';

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  INITIALIZATION
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function init() {
  loadData();
  renderCardStack();
  setupGestures();
  
  // Create welcome note if empty
  if (Object.keys(notes).length === 0) {
    const id = genId();
    notes[id] = {
      id,
      title: 'Welcome to Zettelkasten',
      body: `Your personal card box for knowledge

Swipe left ‚Üê to go back
Swipe right ‚Üí to go forward
Tap Edit to modify this card
Tap + to create new cards

Use [[double brackets]] to link notes
Add #tags to organize thoughts

Types:
üü† Fleeting - quick ideas
üîµ Literature - from sources  
üü¢ Permanent - refined insights

Start capturing your thoughts!`,
      type: 'permanent',
      starred: false,
      created: Date.now(),
      modified: Date.now(),
      tags: ['welcome']
    };
    saveData();
  }
  
  renderCardStack();
}

function genId() {
  return Date.now().toString(36) + Math.random().toString(36).slice(2, 7);
}

function loadData() {
  try {
    const data = localStorage.getItem(STORAGE_KEY);
    notes = data ? JSON.parse(data) : {};
  } catch {
    notes = {};
  }
}

function saveData() {
  localStorage.setItem(STORAGE_KEY, JSON.stringify(notes));
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  CARD STACK
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function renderCardStack() {
  const container = document.getElementById('card-stack');
  const noteList = Object.values(notes).sort((a, b) => b.modified - a.modified);
  
  if (noteList.length === 0) {
    container.innerHTML = `
      <div class="empty-card">
        <div class="empty-icon">üìá</div>
        <div class="empty-title">No cards yet</div>
        <div class="empty-desc">Tap the + button to create your first note card</div>
      </div>
    `;
    return;
  }
  
  // Ensure index is valid
  if (currentCardIndex >= noteList.length) currentCardIndex = noteList.length - 1;
  if (currentCardIndex < 0) currentCardIndex = 0;
  
  container.innerHTML = '';
  
  // Render current card and 2 behind it
  for (let i = currentCardIndex; i < Math.min(currentCardIndex + 3, noteList.length); i++) {
    const note = noteList[i];
    const offset = i - currentCardIndex;
    const card = createCardElement(note, offset);
    container.appendChild(card);
  }
}

function createCardElement(note, stackOffset = 0) {
  const div = document.createElement('div');
  div.className = `index-card ${stackOffset === 0 ? 'current' : 'stack-' + stackOffset}`;
  div.dataset.noteId = note.id;
  
  const linkCount = (note.body || '').match(/\[\[([^\]]+)\]\]/g)?.length || 0;
  const date = formatDate(note.modified);
  const tags = note.tags?.slice(0, 3) || [];
  
  const noteList = Object.values(notes).sort((a, b) => b.modified - a.modified);
  const position = `${currentCardIndex + 1} / ${noteList.length}`;
  
  div.innerHTML = `
    <div class="card-corner ${note.type}"></div>
    
    <div class="card-header">
      <div class="card-title">${note.title || 'Untitled'}</div>
      <div class="card-meta">
        ${note.starred ? '<span>‚≠ê</span>' : ''}
        <span class="card-meta-item">${date}</span>
        ${linkCount > 0 ? `<span class="card-meta-item">üîó ${linkCount}</span>` : ''}
        ${tags.map(t => `<span class="card-tag">#${t}</span>`).join('')}
      </div>
    </div>
    
    <div class="card-body">${formatNoteBody(note.body || 'Empty note')}</div>
    
    <div class="card-footer">
      <div class="card-position">${position}</div>
      <div class="card-actions">
        <div class="card-btn" onclick="toggleStar('${note.id}')">${note.starred ? '‚≠ê' : '‚òÜ'}</div>
        <div class="card-btn primary" onclick="editNote('${note.id}')">‚úèÔ∏è</div>
      </div>
    </div>
  `;
  
  return div;
}

function formatNoteBody(text) {
  // Convert markdown-like syntax to HTML
  let formatted = text
    .replace(/\[\[([^\]]+)\]\]/g, '<span style="color: var(--accent); text-decoration: underline;">$1</span>')
    .replace(/#([a-zA-Z0-9_-]+)/g, '<span style="color: var(--green);">#$1</span>')
    .replace(/\*\*([^*]+)\*\*/g, '<strong>$1</strong>')
    .replace(/\*([^*]+)\*/g, '<em>$1</em>')
    .replace(/\n/g, '<br>');
  
  return formatted;
}

function formatDate(timestamp) {
  const date = new Date(timestamp);
  const now = new Date();
  const diffMs = now - date;
  const diffMins = Math.floor(diffMs / 60000);
  const diffHours = Math.floor(diffMs / 3600000);
  const diffDays = Math.floor(diffMs / 86400000);
  
  if (diffMins < 1) return 'Just now';
  if (diffMins < 60) return `${diffMins}m ago`;
  if (diffHours < 24) return `${diffHours}h ago`;
  if (diffDays < 7) return `${diffDays}d ago`;
  return date.toLocaleDateString();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  GESTURES
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function setupGestures() {
  const stack = document.getElementById('card-stack');
  const hammer = new Hammer(stack);
  
  hammer.on('swipeleft', () => {
    nextCard();
  });
  
  hammer.on('swiperight', () => {
    previousCard();
  });
}

function nextCard() {
  const noteList = Object.values(notes).sort((a, b) => b.modified - a.modified);
  if (currentCardIndex < noteList.length - 1) {
    currentCardIndex++;
    renderCardStack();
  }
}

function previousCard() {
  if (currentCardIndex > 0) {
    currentCardIndex--;
    renderCardStack();
  }
}

function toggleStar(noteId) {
  if (notes[noteId]) {
    notes[noteId].starred = !notes[noteId].starred;
    notes[noteId].modified = Date.now();
    saveData();
    renderCardStack();
    toast(notes[noteId].starred ? 'Starred ‚≠ê' : 'Unstarred');
  }
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  EDIT NOTE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function openNewNote() {
  editingNoteId = null;
  document.getElementById('edit-modal-title').textContent = 'New Note';
  document.getElementById('edit-title').value = '';
  document.getElementById('edit-body').value = '';
  document.querySelectorAll('.type-option').forEach(el => el.classList.remove('active'));
  document.querySelector('[data-type="fleeting"]').classList.add('active');
  showModal('edit-modal');
}

function editNote(noteId) {
  const note = notes[noteId];
  if (!note) return;
  
  editingNoteId = noteId;
  document.getElementById('edit-modal-title').textContent = 'Edit Note';
  document.getElementById('edit-title').value = note.title || '';
  document.getElementById('edit-body').value = note.body || '';
  
  document.querySelectorAll('.type-option').forEach(el => {
    el.classList.toggle('active', el.dataset.type === note.type);
  });
  
  showModal('edit-modal');
}

function selectType(type, el) {
  document.querySelectorAll('.type-option').forEach(e => e.classList.remove('active'));
  el.classList.add('active');
}

function saveEditedNote() {
  const title = document.getElementById('edit-title').value.trim();
  const body = document.getElementById('edit-body').value.trim();
  const type = document.querySelector('.type-option.active')?.dataset.type || 'fleeting';
  
  if (!title && !body) {
    toast('Please add a title or content');
    return;
  }
  
  if (editingNoteId) {
    // Edit existing
    notes[editingNoteId].title = title;
    notes[editingNoteId].body = body;
    notes[editingNoteId].type = type;
    notes[editingNoteId].modified = Date.now();
    
    // Extract tags
    const tags = [...new Set(Array.from(body.matchAll(/#([a-zA-Z0-9_-]+)/g)).map(m => m[1]))];
    notes[editingNoteId].tags = tags;
  } else {
    // Create new
    const id = genId();
    const tags = [...new Set(Array.from(body.matchAll(/#([a-zA-Z0-9_-]+)/g)).map(m => m[1]))];
    
    notes[id] = {
      id,
      title,
      body,
      type,
      starred: false,
      created: Date.now(),
      modified: Date.now(),
      tags
    };
    
    currentCardIndex = 0; // Jump to new note
  }
  
  saveData();
  closeEditModal();
  renderCardStack();
  renderBrowseList();
  toast('Note saved');
}

function closeEditModal() {
  hideModal('edit-modal');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  BROWSE VIEW
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function renderBrowseList() {
  const container = document.getElementById('browse-list');
  let noteList = Object.values(notes).sort((a, b) => b.modified - a.modified);
  
  // Filter
  if (browseFilter === 'starred') noteList = noteList.filter(n => n.starred);
  else if (browseFilter !== 'all') noteList = noteList.filter(n => n.type === browseFilter);
  
  // Search
  if (browseQuery) {
    const q = browseQuery.toLowerCase();
    noteList = noteList.filter(n => 
      (n.title || '').toLowerCase().includes(q) ||
      (n.body || '').toLowerCase().includes(q)
    );
  }
  
  if (noteList.length === 0) {
    container.innerHTML = '<div style="text-align: center; padding: 40px; color: rgba(255,255,255,0.5);">No notes found</div>';
    return;
  }
  
  container.innerHTML = noteList.map((note, index) => {
    const preview = note.body ? note.body.slice(0, 80) : 'Empty note';
    return `
      <div class="note-list-item" onclick="jumpToCard('${note.id}')">
        <div class="note-list-title">${note.starred ? '‚≠ê ' : ''}${note.title || 'Untitled'}</div>
        <div class="note-list-preview">${preview}...</div>
      </div>
    `;
  }).join('');
}

function setBrowseFilter(filter, el) {
  browseFilter = filter;
  document.querySelectorAll('.filter-pill').forEach(p => p.classList.remove('active'));
  el.classList.add('active');
  renderBrowseList();
}

function filterBrowse(query) {
  browseQuery = query;
  renderBrowseList();
}

function jumpToCard(noteId) {
  const noteList = Object.values(notes).sort((a, b) => b.modified - a.modified);
  const index = noteList.findIndex(n => n.id === noteId);
  if (index >= 0) {
    currentCardIndex = index;
    switchView('stack');
    renderCardStack();
  }
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  GRAPH VIEW
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function renderGraph() {
  const svg = d3.select('#graph-svg');
  svg.selectAll('*').remove();
  
  const container = document.getElementById('graph-container');
  const W = container.clientWidth;
  const H = container.clientHeight;
  
  svg.attr('width', W).attr('height', H);
  
  const noteList = Object.values(notes);
  if (noteList.length === 0) return;
  
  const nodes = noteList.map(n => ({ id: n.id, title: n.title || 'Untitled', type: n.type }));
  const links = [];
  
  noteList.forEach(n => {
    const matches = (n.body || '').matchAll(/\[\[([^\]]+)\]\]/g);
    for (const match of matches) {
      const target = noteList.find(nt => nt.title === match[1]);
      if (target) links.push({ source: n.id, target: target.id });
    }
  });
  
  const typeColors = { fleeting: '#ff9f0a', literature: '#0a84ff', permanent: '#32d74b' };
  
  const sim = d3.forceSimulation(nodes)
    .force('link', d3.forceLink(links).id(d => d.id).distance(80))
    .force('charge', d3.forceManyBody().strength(-200))
    .force('center', d3.forceCenter(W/2, H/2));
  
  const g = svg.append('g');
  
  const link = g.append('g').selectAll('line').data(links).join('line')
    .attr('stroke', 'rgba(255,255,255,0.2)').attr('stroke-width', 2);
  
  const node = g.append('g').selectAll('g').data(nodes).join('g')
    .call(d3.drag()
      .on('start', (e, d) => { if (!e.active) sim.alphaTarget(0.3).restart(); d.fx = d.x; d.fy = d.y; })
      .on('drag', (e, d) => { d.fx = e.x; d.fy = e.y; })
      .on('end', (e, d) => { if (!e.active) sim.alphaTarget(0); d.fx = null; d.fy = null; }));
  
  node.append('circle')
    .attr('r', 10)
    .attr('fill', d => typeColors[d.type] || '#999')
    .attr('stroke', '#1c1c1e')
    .attr('stroke-width', 3)
    .on('click', (e, d) => { jumpToCard(d.id); });
  
  node.append('text')
    .attr('dx', 15)
    .attr('dy', 4)
    .attr('fill', 'white')
    .attr('font-size', 12)
    .text(d => d.title.length > 15 ? d.title.slice(0, 15) + '‚Ä¶' : d.title);
  
  sim.on('tick', () => {
    link.attr('x1', d => d.source.x).attr('y1', d => d.source.y)
        .attr('x2', d => d.target.x).attr('y2', d => d.target.y);
    node.attr('transform', d => `translate(${d.x},${d.y})`);
  });
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  VIEWS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function switchView(view) {
  currentView = view;
  
  // Update tab bar
  document.querySelectorAll('.tab-item').forEach((t, i) => {
    const views = ['stack', 'browse', null, 'graph', null];
    t.classList.toggle('active', views[i] === view);
  });
  
  // Show view
  document.querySelectorAll('.view-content').forEach(v => v.classList.add('hidden'));
  
  if (view === 'stack') {
    document.getElementById('card-stack-view').classList.remove('hidden');
    renderCardStack();
  } else if (view === 'browse') {
    document.getElementById('browse-view').classList.remove('hidden');
    renderBrowseList();
  } else if (view === 'graph') {
    document.getElementById('graph-view').classList.remove('hidden');
    setTimeout(renderGraph, 100);
  }
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  SETTINGS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function openSettings() {
  updateStats();
  showModal('settings-modal');
}

function closeSettings() {
  hideModal('settings-modal');
}

function setTheme(theme, el) {
  document.documentElement.setAttribute('data-theme', theme);
  document.querySelectorAll('#settings-modal .type-option').forEach(e => e.classList.remove('active'));
  el.classList.add('active');
  toast(`Switched to ${theme} mode`);
}

function updateStats() {
  document.getElementById('stat-notes').textContent = Object.keys(notes).length;
  
  let totalLinks = 0;
  Object.values(notes).forEach(n => {
    totalLinks += ((n.body || '').match(/\[\[([^\]]+)\]\]/g) || []).length;
  });
  document.getElementById('stat-links').textContent = totalLinks;
  
  const allTags = new Set();
  Object.values(notes).forEach(n => {
    (n.tags || []).forEach(t => allTags.add(t));
  });
  document.getElementById('stat-tags').textContent = allTags.size;
}

function exportData() {
  const data = { notes, exported: new Date().toISOString() };
  const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'zettelkasten-cards-backup.json';
  a.click();
  URL.revokeObjectURL(url);
  toast('Data exported');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  MODALS & TOAST
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function showModal(id) {
  document.getElementById(id).classList.add('visible');
}

function hideModal(id) {
  document.getElementById(id).classList.remove('visible');
}

function toast(message) {
  const el = document.getElementById('toast');
  el.textContent = message;
  el.classList.add('visible');
  setTimeout(() => el.classList.remove('visible'), 2000);
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  INIT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

init();
</script>
</body>
</html>
